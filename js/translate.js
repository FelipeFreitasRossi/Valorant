// translate.js - Sistema de Internacionalização para VALORANT

const translations = {
    pt: {
        // Navegação
        home: "Início",
        agents: "Agentes",
        arsenal: "Arsenal",
        maps: "Mapas",
        news: "Notícias",
        playFree: "Jogar Grátis",
        
        valorant: "VALORANT",
        defyLimits: "Desafie os Limites",
        playNow: "Jogar Agora",
        watchTrailer: "Ver Trailer",
        
        yourAgents: "Seus Agentes",
        chooseCharacter: "Escolha Seu Personagem",
        agentDescription: "Misture seu estilo e experiência em um palco competitivo global. Você tem 13 rodadas para atacar e defender seu lado usando tiros precisos e habilidades táticas.",
        duelists: "Duelistas",
        duelistsDesc: "Fraggers autossuficientes que sua equipe espera, através de habilidades e técnicas, conseguir muitas eliminações e buscar engajamentos primeiro.",
        controllers: "Controladores",
        controllersDesc: "Especialistas em dividir territórios perigosos para preparar sua equipe para o sucesso com controle de visão e negação de área.",
        initiators: "Iniciadores",
        initiatorsDesc: "Desafie ângulos preparando sua equipe para entrar em terreno contestado e afastar os defensores de posições-chave.",
        sentinels: "Sentinels",
        sentinelsDesc: "Especialistas defensivos que podem trancar áreas e vigiar flancos, tanto em rodadas de ataque quanto de defesa.",
        
        // Arsenal section
        arsenalTitle: "Precisão Tática Encontra Força Letal",
        arsenalDesc1: "Cada arma no VALORANT requer sua própria estratégia e estilo de jogo. Domine os padrões de recuo, entenda a economia e domine o campo de batalha com mira perfeita.",
        arsenalDesc2: "De pistolas a metralhadoras pesadas, cada arma foi meticulosamente projetada para fornecer profundidade tática e recompensar jogadores habilidosos.",
        weapons: "Armas",
        
        // CTA
        ctaTitle: "Pronto para Entrar na Luta?",
        ctaDesc: "Baixe o VALORANT e comece sua jornada competitiva hoje",
        getStarted: "Começar",
        
        // Footer
        footerDesc: "Um FPS tático baseado em personagens 5v5 onde tiros precisos se encontram com habilidades de agente únicas.",
        game: "Jogo",
        esports: "Esports",
        support: "Suporte",
        patchNotes: "Notas de Atualização",
        vct: "VCT",
        champions: "Champions",
        masters: "Masters",
        gameChangers: "Game Changers",
        helpCenter: "Central de Ajuda",
        privacyPolicy: "Política de Privacidade",
        termsOfService: "Termos de Serviço",
        contact: "Contato",
        copyright: "&copy; 2025 Riot Games, Inc. VALORANT e quaisquer logotipos associados são marcas comerciais, marcas de serviço e/ou marcas registradas da Riot Games, Inc.",
        
        // Título da página
        pageTitle: "VALORANT - FPS Tático"
    },
    en: {
        home: "Home",
        agents: "Agents",
        arsenal: "Arsenal",
        maps: "Maps",
        news: "News",
        playFree: "Play Free",
        valorant: "VALORANT",
        defyLimits: "Defy The Limits",
        playNow: "Play Now",
        watchTrailer: "Watch Trailer",
        yourAgents: "Your Agents",
        chooseCharacter: "Choose Your Character",
        agentDescription: "Blend your style and experience on a global, competitive stage. You have 13 rounds to attack and defend your side using sharp gunplay and tactical abilities.",
        duelists: "Duelists",
        duelistsDesc: "Self-sufficient fraggers who their team expects, through abilities and skills, to get high frags and seek out engagements first.",
        controllers: "Controllers",
        controllersDesc: "Experts in slicing up dangerous territory to set their team up for success with vision control and area denial.",
        initiators: "Initiators",
        initiatorsDesc: "Challenge angles by setting up their team to enter contested ground and push defenders away from key positions.",
        sentinels: "Sentinels",
        sentinelsDesc: "Defensive specialists who can lock down areas and watch flanks, both on attacker and defender rounds.",
        arsenalTitle: "Tactical Precision Meets Lethal Force",
        arsenalDesc1: "Every weapon in VALORANT requires its own unique strategy and playstyle. Master the recoil patterns, understand the economy, and dominate the battlefield with perfect aim.",
        arsenalDesc2: "From pistols to heavy machine guns, each weapon has been meticulously designed to provide tactical depth and reward skilled players.",
        weapons: "Weapons",
        ctaTitle: "Ready To Join The Fight?",
        ctaDesc: "Download VALORANT and start your competitive journey today",
        getStarted: "Get Started",
        footerDesc: "A 5v5 character-based tactical FPS where precise gunplay meets unique agent abilities.",
        game: "Game",
        esports: "Esports",
        support: "Support",
        patchNotes: "Patch Notes",
        vct: "VCT",
        champions: "Champions",
        masters: "Masters",
        gameChangers: "Game Changers",
        helpCenter: "Help Center",
        privacyPolicy: "Privacy Policy",
        termsOfService: "Terms of Service",
        contact: "Contact",
        pageTitle: "VALORANT - Tactical FPS"
    },
    es: {
        home: "Inicio",
        agents: "Agentes",
        arsenal: "Arsenal",
        maps: "Mapas",
        news: "Noticias",
        playFree: "Jugar Gratis",
        valorant: "VALORANT",
        defyLimits: "Desafía los Límites",
        playNow: "Jugar Ahora",
        watchTrailer: "Ver Tráiler",
        yourAgents: "Tus Agentes",
        chooseCharacter: "Elige Tu Personaje",
        agentDescription: "Combina tu estilo y experiencia en un escenario competitivo global. Tienes 13 rondas para atacar y defender tu lado usando un juego de armas agudo y habilidades tácticas.",
        duelists: "Duelistas",
        duelistsDesc: "Fraggers autosuficientes de los que su equipo espera, a través de habilidades y destrezas, que consigan muchas eliminaciones y busquen enfrentamientos primero.",
        controllers: "Controladores",
        controllersDesc: "Expertos en dividir territorios peligrosos para preparar a su equipo para el éxito con control de visión y denegación de área.",
        initiators: "Iniciadores",
        initiatorsDesc: "Desafía ángulos preparando a tu equipo para entrar en terreno disputado y alejar a los defensores de posiciones clave.",
        sentinels: "Centinelas",
        sentinelsDesc: "Especialistas defensivos que pueden bloquear áreas y vigilar flancos, tanto en rondas de atacante como de defensor.",
        arsenalTitle: "Precisión Táctica Encuentra Fuerza Letal",
        arsenalDesc1: "Cada arma en VALORANT requiere su propia estrategia y estilo de juego. Domina los patrones de retroceso, comprende la economía y domina el campo de batalla con puntería perfecta.",
        arsenalDesc2: "Desde pistolas hasta ametralladoras pesadas, cada arma ha sido meticulosamente diseñada para proporcionar profundidad táctica y recompensar a los jugadores habilidosos.",
        weapons: "Armas",
        ctaTitle: "¿Listo para Unirte a la Lucha?",
        ctaDesc: "Descarga VALORANT y comienza tu viaje competitivo hoy",
        getStarted: "Empezar",
        footerDesc: "Un FPS táctico basado en personajes 5v5 donde el juego de armas preciso se encuentra con habilidades de agente únicas.",
        game: "Juego",
        esports: "Esports",
        support: "Soporte",
        patchNotes: "Notas de Parche",
        vct: "VCT",
        champions: "Campeones",
        masters: "Masters",
        gameChangers: "Game Changers",
        helpCenter: "Centro de Ayuda",
        privacyPolicy: "Política de Privacidad",
        termsOfService: "Términos de Servicio",
        contact: "Contacto",
        pageTitle: "VALORANT - FPS Táctico"
    }
};

// Sistema de tradução
class Translator {
    constructor() {
        this.currentLang = 'pt';
        this.init();
    }
    
    // Inicializa o sistema de tradução
    init() {
        // Tenta carregar o idioma salvo ou detectar o idioma do navegador
        this.loadSavedLanguage();
        
        // Configura o seletor de idioma
        this.setupLanguageSelector();
        
        // Aplica as traduções
        this.applyTranslations();
        
        // Atualiza o atributo lang do HTML
        document.documentElement.lang = this.currentLang;
    }
    
    // Carrega o idioma salvo no localStorage ou detecta o idioma do navegador
    loadSavedLanguage() {
        const savedLang = localStorage.getItem('valorant_language');
        
        if (savedLang && translations[savedLang]) {
            this.currentLang = savedLang;
        } else {
            // Detectar idioma do navegador
            const browserLang = navigator.language.substring(0, 2);
            if (translations[browserLang]) {
                this.currentLang = browserLang;
            }
        }
    }
    
    // Configura o seletor de idioma
    setupLanguageSelector() {
        const languageSelect = document.getElementById('languageSelect');
        
        if (languageSelect) {
            // Define o valor atual
            languageSelect.value = this.currentLang;
            
            // Adiciona o event listener
            languageSelect.addEventListener('change', (e) => {
                this.changeLanguage(e.target.value);
            });
        }
        
        // Configurar também o seletor mobile se existir
        const languageSelectMobile = document.getElementById('languageSelectMobile');
        if (languageSelectMobile) {
            languageSelectMobile.value = this.currentLang;
            languageSelectMobile.addEventListener('change', (e) => {
                this.changeLanguage(e.target.value);
            });
        }
    }
    
    // Muda o idioma
    changeLanguage(lang) {
        if (!translations[lang]) {
            console.error(`Idioma "${lang}" não suportado.`);
            return;
        }
        
        // Atualiza o idioma atual
        this.currentLang = lang;
        
        // Salva no localStorage
        localStorage.setItem('valorant_language', lang);
        
        // Atualiza o atributo lang do HTML
        document.documentElement.lang = lang;
        
        // Aplica as traduções
        this.applyTranslations();
        
        // Atualiza os seletores
        this.updateLanguageSelectors();
        
        // Dispara um evento customizado
        this.dispatchLanguageChangeEvent();
    }
    
    // Aplica as traduções a todos os elementos com data-i18n-key
    applyTranslations() {
        // Traduz elementos comuns
        const elements = document.querySelectorAll('[data-i18n-key]');
        elements.forEach(element => {
            const key = element.getAttribute('data-i18n-key');
            this.translateElement(element, key);
        });
        
        // Atualiza o título da página
        this.updatePageTitle();
    }
    
    // Traduz um elemento específico
    translateElement(element, key) {
        if (!translations[this.currentLang][key]) {
            console.warn(`Chave de tradução não encontrada: "${key}"`);
            return;
        }
        
        const translation = translations[this.currentLang][key];
        
        // Verifica o tipo de elemento
        if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA' || element.tagName === 'SELECT') {
            // Para inputs, textareas e selects
            if (element.hasAttribute('placeholder')) {
                element.setAttribute('placeholder', translation);
            } else {
                element.value = translation;
            }
        } else if (element.hasAttribute('title')) {
            // Para elementos com atributo title
            element.setAttribute('title', translation);
        } else if (element.hasAttribute('alt')) {
            // Para elementos com atributo alt (imagens)
            element.setAttribute('alt', translation);
        } else {
            // Para elementos de texto normais
            element.textContent = translation;
        }
    }
    
    // Atualiza o título da página
    updatePageTitle() {
        const titleKey = 'pageTitle';
        if (translations[this.currentLang][titleKey]) {
            document.title = translations[this.currentLang][titleKey];
        }
    }
    
    // Atualiza os seletores de idioma
    updateLanguageSelectors() {
        const languageSelect = document.getElementById('languageSelect');
        const languageSelectMobile = document.getElementById('languageSelectMobile');
        
        if (languageSelect) {
            languageSelect.value = this.currentLang;
        }
        
        if (languageSelectMobile) {
            languageSelectMobile.value = this.currentLang;
        }
    }
    
    // Dispara um evento quando o idioma é alterado
    dispatchLanguageChangeEvent() {
        const event = new CustomEvent('languageChanged', {
            detail: { language: this.currentLang }
        });
        document.dispatchEvent(event);
    }
    
    // Método para obter uma tradução específica
    translate(key) {
        return translations[this.currentLang][key] || key;
    }
    
    // Retorna o idioma atual
    getCurrentLanguage() {
        return this.currentLang;
    }
}

// Inicializa o tradutor quando o DOM estiver carregado
document.addEventListener('DOMContentLoaded', () => {
    // Cria uma instância global do tradutor
    window.translator = new Translator();
    
    // Adiciona um event listener para o evento de mudança de idioma
    document.addEventListener('languageChanged', (e) => {
        console.log(`Idioma alterado para: ${e.detail.language}`);
        // Aqui você pode adicionar outras ações que devem ocorrer quando o idioma muda
    });
});

// Função auxiliar para traduzir strings dinamicamente
function t(key) {
    if (window.translator) {
        return window.translator.translate(key);
    }
    return key;
}

// Função para mudar o idioma globalmente
function changeLanguage(lang) {
    if (window.translator) {
        window.translator.changeLanguage(lang);
    }
}

// Exporta as funções para uso global
if (typeof module !== 'undefined' && module.exports) {
    module.exports = { Translator, t, changeLanguage };
}